<%# Show review - nested route (ESaaS Â§5.6) %>
<%# URL: /movies/:movie_id/reviews/:id %>

<h1>Review for <%= @movie.title %></h1>

<div class="card mb-4">
  <div class="card-body">
    <h3 class="card-title">
      <% @review.potatoes.times do %>
        ðŸ¥”
      <% end %>
      <% (5 - @review.potatoes).times do %>
        âšª
      <% end %>
    </h3>
    <h5 class="card-subtitle mb-2 text-muted">
      <%= @review.potatoes %> out of 5 potatoes
    </h5>
    <p class="card-text">
      <small class="text-muted">
        Reviewed by <%= @review.moviegoer.name || @review.moviegoer.email || 'Anonymous' %>
        on <%= @review.created_at.strftime('%B %d, %Y at %I:%M %p') %>
      </small>
    </p>

    <% if logged_in? && current_user == @review.moviegoer %>
      <div class="mt-3">
        <%= link_to 'Edit Review', edit_movie_review_path(@movie, @review), class: 'btn btn-primary' %>
        <%= button_to 'Delete Review', movie_review_path(@movie, @review),
            method: :delete, class: 'btn btn-danger',
            data: { turbo_confirm: 'Are you sure you want to delete this review?' } %>
      </div>
    <% end %>
  </div>
</div>

<%= link_to 'All Reviews for this Movie', movie_reviews_path(@movie), class: 'btn btn-secondary' %>
<%= link_to 'Back to Movie', @movie, class: 'btn btn-link' %>
